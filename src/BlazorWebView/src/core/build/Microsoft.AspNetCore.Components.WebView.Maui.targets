<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <StaticWebAssetBasePath>/</StaticWebAssetBasePath>
  </PropertyGroup>
    
  <Target Name="CopyStaticWebAssetsToOutputFolder" BeforeTargets="GetCopyToOutputDirectoryItems" DependsOnTargets="ResolveStaticWebAssetsInputs">
    <ItemGroup>
      <AllItemsFullPathWithTargetPath Include="%(StaticWebAsset.Identity)" Condition="'%(StaticWebAsset.SourceType)' != ''">
        <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
        <TargetPath>$([System.String]::Copy('wwwroot\%(StaticWebAsset.BasePath)\%(StaticWebAsset.RelativePath)').Replace('/','\').Replace('\\\','\').Replace('\\','\'))</TargetPath>
      </AllItemsFullPathWithTargetPath>
      <AllItemsFullPathWithTargetPath Include="%(StaticWebAsset.Identity)" Condition="'%(StaticWebAsset.SourceType)' == ''">
        <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
        <TargetPath>wwwroot\%(StaticWebAsset.RelativePath)</TargetPath>
      </AllItemsFullPathWithTargetPath>
    </ItemGroup>
    <Message Text="Converting assets..." />
  </Target>

  <Target Name="_BlazorDesktopReplaceBundle" AfterTargets="_AddGeneratedScopedCssFilesForReference" DependsOnTargets="_ComputeCssBundles">
    <ItemGroup>
      <StaticWebAsset Include="@(_AppBundleStaticWebAsset)">
        <SourceType></SourceType>
      </StaticWebAsset>
      <Staticwebasset Remove="@(_ProjectBundleStaticWebAsset)" />
    </ItemGroup>
  </Target>

  <PropertyGroup>
    <GetCurrentProjectStaticWebAssetsDependsOn>
      $(GetCurrentProjectStaticWebAssets);
      _BlazorDesktopReplaceBundle2;
    </GetCurrentProjectStaticWebAssetsDependsOn>
  </PropertyGroup>

  <Target Name="_BlazorDesktopReplaceBundle2" DependsOnTargets="_PrepareForBundling">
    <ItemGroup>      
      <_AppBundleStaticWebAsset Include="$(_ScopedCssOutputPath)" Condition="Exists('$(_ScopedCssOutputPath)')">
        <SourceType></SourceType>
        <SourceId>$(PackageId)</SourceId>
        <ContentRoot>$(_ScopedCssBundleContentRoot)</ContentRoot>
        <BasePath>$(_ScopedCssBundleBasePath)</BasePath>
        <RelativePath>$(PackageId).styles.css</RelativePath>
      </_AppBundleStaticWebAsset>

      <StaticWebAsset Include="@(_AppBundleStaticWebAsset)">
        <SourceType></SourceType>
      </StaticWebAsset>

    </ItemGroup>
  </Target>

</Project>
